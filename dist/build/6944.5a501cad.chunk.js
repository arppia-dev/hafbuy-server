"use strict";(self.webpackChunke_commerce_server=self.webpackChunke_commerce_server||[]).push([[6944],{46944:($,g,t)=>{t.d(g,{ProtectedListView:()=>rt});var s=t(19968),P=t(62552),B=t(8612),W=t(37272),i=t(50484),A=t(41868),o=t(71812),L=t(45676),U=t(78164),K=t(12132),_=t(14632),h=t(48632),I=t(70516),y=t(49008),f=t(9252),c=t(63648),x=t(35456),z=t(17892),Y=t(31212),k=t(38188),G=t(54320),u=t(5240),H=t(91892),Q=t(36196),J=t(20880),X=t(21424),a=t(31812),r=t(18424),l=t(52540),M=t(21968),D=t(85676),E=t(35184),d=t(99568),C=t(96556),O=t(13192),R=t(30840),Z=t(77784),w=t(79371),b=t(67888),q=t(52600),tt=t(95752),e=t(37388),st=t(61840),j=t(49108),Ct=t(44632),gt=t(50840),vt=t(20252),Lt=t(86432),Ut=t(22612),ht=t(24808),It=t(24024),Rt=t(33656),Bt=t(43280),Wt=t(79804),Kt=t(19632),yt=t(29576),xt=t(61152),ut=t(9589),jt=t(45488),St=t(75516);const ot=[{name:"name",key:"name",metadatas:{label:{id:"Settings.tokens.ListView.headers.name",defaultMessage:"Name"},sortable:!0}},{name:"description",key:"description",metadatas:{label:{id:"Settings.tokens.ListView.headers.description",defaultMessage:"Description"},sortable:!1}},{name:"createdAt",key:"createdAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.createdAt",defaultMessage:"Created at"},sortable:!1}},{name:"lastUsedAt",key:"lastUsedAt",metadatas:{label:{id:"Settings.tokens.ListView.headers.lastUsedAt",defaultMessage:"Last used"},sortable:!1}}],_t=()=>{(0,o.G0)();const{formatMessage:T}=(0,_.c)(),v=(0,o.eo)(),dt=(0,I.w1)(f.s),{allowedActions:{canCreate:S,canDelete:Et,canUpdate:it,canRead:m}}=(0,o.aU)(dt.settings["transfer-tokens"]),{push:at}=(0,y.Uz)(),{trackUsage:p}=(0,o.m4)(),{startSection:lt}=(0,o.sg)(),nt=P.useRef(lt),{get:Mt,del:Dt}=(0,o.Qn)();P.useEffect(()=>{nt.current&&nt.current("transferTokens")},[]),P.useEffect(()=>{at({search:K.stringify({sort:"name:ASC"},{encode:!1})})},[at]);const Ot=ot.map(n=>({...n,metadatas:{...n.metadatas,label:T(n.metadatas.label)}})),{data:N,status:V,isFetching:Pt,refetch:ct}=(0,h.useQuery)(["transfer-tokens"],async()=>{p("willAccessTokenList",{tokenType:c.T});const{data:{data:n}}=await Mt("/admin/transfer/tokens");return p("didAccessTokenList",{number:n.length,tokenType:c.T}),n},{enabled:m,onError(n){n instanceof U.Uh&&(n?.response?.data?.error?.details?.code==="INVALID_TOKEN_SALT"?v({type:"warning",message:{id:"notification.error.invalid.configuration",defaultMessage:"You have an invalid configuration, check your server log for more information."}}):v({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}))}}),et=m&&(V!=="success"&&V!=="error"||V==="success"&&Pt),Tt=(0,h.useMutation)(async n=>{await Dt(`/admin/transfer/tokens/${n}`)},{async onSuccess(){await ct(["transfer-tokens"])},onError(n){n instanceof U.Uh&&(n?.response?.data?.data?v({type:"warning",message:n.response.data.data}):n?.response?.data?.error?.details?.code==="INVALID_TOKEN_SALT"?v({type:"warning",message:{id:"notification.error.invalid.configuration",defaultMessage:"You have an invalid configuration, check your server log for more information."}}):v({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}))}}),F=N&&N?.length>0,mt=m&&F,At=m&&!F&&!S,ft=m&&!F&&S;return(0,s.jsxs)(B.G,{"aria-busy":et,children:[(0,s.jsx)(o.K8,{name:"Transfer Tokens"}),(0,s.jsx)(W.a,{title:T({id:"Settings.transferTokens.title",defaultMessage:"Transfer Tokens"}),subtitle:T({id:"Settings.transferTokens.description",defaultMessage:'"List of generated transfer tokens"'}),primaryAction:S?(0,s.jsx)(i.E,{"data-testid":"create-transfer-token-button",startIcon:(0,s.jsx)(L.c,{}),size:"S",onClick:()=>p("willAddTokenFromList",{tokenType:c.T}),to:"/settings/transfer-tokens/create",children:T({id:"Settings.transferTokens.create",defaultMessage:"Create new Transfer Token"})}):void 0}),(0,s.jsxs)(A.S,{children:[!m&&(0,s.jsx)(o.o5,{}),mt&&(0,s.jsx)(x.T,{permissions:{canRead:m,canDelete:Et,canUpdate:it},headers:Ot,contentType:"trasfer-tokens",isLoading:et,onConfirmDelete:n=>Tt.mutateAsync(n),tokens:N,tokenType:c.T}),ft&&(0,s.jsx)(o.kP,{content:{id:"Settings.transferTokens.addFirstToken",defaultMessage:"Add your first Transfer Token"},action:(0,s.jsx)(i.E,{variant:"secondary",startIcon:(0,s.jsx)(L.c,{}),to:"/settings/transfer-tokens/create",children:T({id:"Settings.transferTokens.addNewToken",defaultMessage:"Add new Transfer Token"})})}),At&&(0,s.jsx)(o.kP,{content:{id:"Settings.transferTokens.emptyStateLayout",defaultMessage:"You don\u2019t have any content yet..."}})]})]})},rt=()=>{const T=(0,I.w1)(f.s);return(0,s.jsx)(o.rF,{permissions:T.settings?.["transfer-tokens"].main,children:(0,s.jsx)(_t,{})})}},35456:($,g,t)=>{t.d(g,{T:()=>Y});var s=t(19968),P=t(62552),B=t(35560),W=t(69856),i=t(20592),A=t(65080),o=t(1560),L=t(84664),U=t(62680),K=t(46928),_=t(71812),h=t(25876),I=t(84564),y=t(22224),f=t(14632),c=t(49008),x=t(39380),z=t(69372);const Y=({permissions:a,headers:r=[],contentType:l,isLoading:M=!1,tokens:D=[],onConfirmDelete:E,tokenType:d})=>{const{canDelete:C,canUpdate:O,canRead:R}=a;return(0,s.jsx)(_.AL,{headers:r,contentType:l,rows:D,withBulkActions:C||O||R,isLoading:M,onConfirmDelete:E,children:(0,s.jsx)(k,{tokenType:d,permissions:a,onConfirmDelete:E})})},k=({tokenType:a,permissions:r,rows:l=[],withBulkActions:M,onConfirmDelete:D})=>{const{canDelete:E,canUpdate:d,canRead:C}=r,[{query:O}]=(0,_.WK)(),{formatMessage:R}=(0,f.c)(),[,Z]=O&&O.sort?O.sort.split(":"):[void 0,"ASC"],{push:w,location:{pathname:b}}=(0,c.Uz)(),{trackUsage:q}=(0,_.m4)(),tt=l.sort((e,st)=>{const j=e.name.localeCompare(st.name);return Z==="DESC"?-j:j});return(0,s.jsx)(B.K,{children:tt.map(e=>(0,s.jsxs)(W.Tr,{...(0,_.on)({fn(){q("willEditTokenFromList",{tokenType:a}),w(`${b}/${e.id}`)},condition:d}),children:[(0,s.jsx)(i.Td,{maxWidth:(0,_.W8)(250),children:(0,s.jsx)(A.O,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0,children:e.name})}),(0,s.jsx)(i.Td,{maxWidth:(0,_.W8)(250),children:(0,s.jsx)(A.O,{textColor:"neutral800",ellipsis:!0,children:e.description})}),(0,s.jsx)(i.Td,{children:(0,s.jsx)(A.O,{textColor:"neutral800",children:(0,s.jsx)(_.od,{timestamp:new Date(e.createdAt)})})}),(0,s.jsx)(i.Td,{children:e.lastUsedAt&&(0,s.jsx)(A.O,{textColor:"neutral800",children:(0,s.jsx)(_.od,{timestamp:new Date(e.lastUsedAt),customIntervals:[{unit:"hours",threshold:1,text:R({id:"Settings.apiTokens.lastHour",defaultMessage:"last hour"})}]})})}),M&&(0,s.jsx)(i.Td,{children:(0,s.jsxs)(o.C,{justifyContent:"end",children:[d&&(0,s.jsx)(X,{tokenName:e.name,tokenId:e.id}),!d&&C&&(0,s.jsx)(J,{tokenName:e.name,tokenId:e.id}),E&&(0,s.jsx)(Q,{tokenName:e.name,onClickDelete:()=>D?.(e.id),tokenType:a})]})})]},e.id))})},G={edit:{id:"app.component.table.edit",defaultMessage:"Edit {target}"},read:{id:"app.component.table.read",defaultMessage:"Read {target}"}},u=({tokenName:a,tokenId:r,buttonType:l="edit",children:M})=>{const{formatMessage:D}=(0,f.c)(),{location:{pathname:E}}=(0,c.Uz)();return(0,s.jsx)(H,{forwardedAs:x.NavLink,to:`${E}/${r}`,title:D(G[l],{target:a}),children:M})},H=(0,z.default)(K.c)`
  svg {
    path {
      fill: ${({theme:a})=>a.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:a})=>a.colors.neutral800};
      }
    }
  }
`,Q=({tokenName:a,onClickDelete:r,tokenType:l})=>{const{formatMessage:M}=(0,f.c)(),{trackUsage:D}=(0,_.m4)(),[E,d]=P.useState(!1),C=()=>{d(!1),D("willDeleteToken",{tokenType:l}),r()};return(0,s.jsxs)(L.k,{paddingLeft:1,onClick:O=>O.stopPropagation(),children:[(0,s.jsx)(U.w,{onClick:()=>{d(!0)},label:M({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${a}`}),name:"delete",borderWidth:0,icon:(0,s.jsx)(h.c,{})}),(0,s.jsx)(_.cz,{onToggleDialog:()=>d(!1),onConfirm:C,isOpen:E})]})},J=({tokenName:a,tokenId:r})=>(0,s.jsx)(u,{tokenName:a,tokenId:r,buttonType:"read",children:(0,s.jsx)(I.c,{})}),X=({tokenName:a,tokenId:r})=>(0,s.jsx)(u,{tokenName:a,tokenId:r,children:(0,s.jsx)(y.c,{})})},63648:($,g,t)=>{t.d(g,{A:()=>s,T:()=>P});const s="api-token",P="transfer-token"}}]);
