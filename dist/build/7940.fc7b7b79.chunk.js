"use strict";(self.webpackChunke_commerce_server=self.webpackChunke_commerce_server||[]).push([[7940],{27940:(F,L,t)=>{t.d(L,{ProtectedListView:()=>dt});var s=t(19968),O=t(62552),W=t(8612),K=t(37272),l=t(50484),c=t(41868),e=t(71812),I=t(45676),R=t(78164),f=t(12132),o=t(14632),U=t(48632),h=t(70516),x=t(49008),m=t(9252),T=t(63648),y=t(35456),V=t(17892),z=t(31212),Q=t(38188),k=t(54320),j=t(5240),G=t(91892),Y=t(36196),H=t(20880),J=t(21424),a=t(31812),E=t(18424),D=t(52540),M=t(21968),P=t(85676),i=t(35184),d=t(99568),A=t(96556),r=t(13192),g=t(30840),X=t(77784),Z=t(79371),w=t(67888),b=t(52600),q=t(95752),n=t(37388),tt=t(61840),p=t(49108),Lt=t(44632),Ut=t(50840),vt=t(20252),It=t(86432),Rt=t(22612),ht=t(24808),gt=t(24024),Bt=t(33656),Wt=t(43280),Kt=t(79804),ft=t(19632),xt=t(29576),yt=t(61152),jt=t(9589),pt=t(45488),ut=t(75516);const ot=[{name:"name",key:"name",metadatas:{label:{id:"Settings.apiTokens.ListView.headers.name",defaultMessage:"Name"},sortable:!0}},{name:"description",key:"description",metadatas:{label:{id:"Settings.apiTokens.ListView.headers.description",defaultMessage:"Description"},sortable:!1}},{name:"createdAt",key:"createdAt",metadatas:{label:{id:"Settings.apiTokens.ListView.headers.createdAt",defaultMessage:"Created at"},sortable:!1}},{name:"lastUsedAt",key:"lastUsedAt",metadatas:{label:{id:"Settings.apiTokens.ListView.headers.lastUsedAt",defaultMessage:"Last used"},sortable:!1}}],Et=()=>{(0,e.G0)();const u=(0,U.useQueryClient)(),{formatMessage:v}=(0,o.c)(),st=(0,e.eo)(),it=(0,h.w1)(m.s),{allowedActions:{canCreate:S,canDelete:lt,canUpdate:Dt,canRead:C}}=(0,e.aU)(it.settings?.["api-tokens"]),{push:at}=(0,x.Uz)(),{trackUsage:B}=(0,e.m4)(),{startSection:Mt}=(0,e.sg)(),nt=O.useRef(Mt),{get:Pt,del:rt}=(0,e.Qn)(),{formatAPIError:_t}=(0,e.An)();O.useEffect(()=>{nt.current&&nt.current("apiTokens")},[]),O.useEffect(()=>{at({search:f.stringify({sort:"name:ASC"},{encode:!1})})},[at]);const Ot=ot.map(_=>({..._,metadatas:{..._.metadatas,label:v(_.metadatas.label)}})),{data:N,isLoading:Tt}=(0,U.useQuery)(["api-tokens"],async()=>{B("willAccessTokenList",{tokenType:T.A});const{data:{data:_}}=await Pt("/admin/api-tokens");return B("didAccessTokenList",{number:_.length,tokenType:T.A}),_},{cacheTime:0,enabled:C,onError(_){_ instanceof R.Uh&&st({type:"warning",message:_t(_)})}}),et=Tt,ct=(0,U.useMutation)(async _=>{await rt(`/admin/api-tokens/${_}`)},{async onSuccess(){await u.invalidateQueries(["api-tokens"]),B("didDeleteToken")},onError(_){_ instanceof R.Uh&&st({type:"warning",message:_t(_)})}}),$=N&&N.length>0,mt=C&&$,At=C&&!$&&!S,Ct=C&&!$&&S;return(0,s.jsxs)(W.G,{"aria-busy":et,children:[(0,s.jsx)(e.K8,{name:"API Tokens"}),(0,s.jsx)(K.a,{title:v({id:"Settings.apiTokens.title",defaultMessage:"API Tokens"}),subtitle:v({id:"Settings.apiTokens.description",defaultMessage:"List of generated tokens to consume the API"}),primaryAction:S&&(0,s.jsx)(l.E,{"data-testid":"create-api-token-button",startIcon:(0,s.jsx)(I.c,{}),size:"S",onClick:()=>B("willAddTokenFromList",{tokenType:T.A}),to:"/settings/api-tokens/create",children:v({id:"Settings.apiTokens.create",defaultMessage:"Create new API Token"})})}),(0,s.jsxs)(c.S,{children:[!C&&(0,s.jsx)(e.o5,{}),mt&&(0,s.jsx)(y.T,{permissions:{canRead:C,canDelete:lt,canUpdate:Dt},headers:Ot,contentType:"api-tokens",isLoading:et,onConfirmDelete:_=>ct.mutateAsync(_),tokens:N,tokenType:T.A}),Ct&&(0,s.jsx)(e.kP,{content:{id:"Settings.apiTokens.addFirstToken",defaultMessage:"Add your first API Token"},action:(0,s.jsx)(l.E,{variant:"secondary",startIcon:(0,s.jsx)(I.c,{}),to:"/settings/api-tokens/create",children:v({id:"Settings.apiTokens.addNewToken",defaultMessage:"Add new API Token"})})}),At&&(0,s.jsx)(e.kP,{content:{id:"Settings.apiTokens.emptyStateLayout",defaultMessage:"You don\u2019t have any content yet..."}})]})]})},dt=()=>{const u=(0,h.w1)(m.s);return(0,s.jsx)(e.rF,{permissions:u.settings?.["api-tokens"].main,children:(0,s.jsx)(Et,{})})}},35456:(F,L,t)=>{t.d(L,{T:()=>z});var s=t(19968),O=t(62552),W=t(35560),K=t(69856),l=t(20592),c=t(65080),e=t(1560),I=t(84664),R=t(62680),f=t(46928),o=t(71812),U=t(25876),h=t(84564),x=t(22224),m=t(14632),T=t(49008),y=t(39380),V=t(69372);const z=({permissions:a,headers:E=[],contentType:D,isLoading:M=!1,tokens:P=[],onConfirmDelete:i,tokenType:d})=>{const{canDelete:A,canUpdate:r,canRead:g}=a;return(0,s.jsx)(o.AL,{headers:E,contentType:D,rows:P,withBulkActions:A||r||g,isLoading:M,onConfirmDelete:i,children:(0,s.jsx)(Q,{tokenType:d,permissions:a,onConfirmDelete:i})})},Q=({tokenType:a,permissions:E,rows:D=[],withBulkActions:M,onConfirmDelete:P})=>{const{canDelete:i,canUpdate:d,canRead:A}=E,[{query:r}]=(0,o.WK)(),{formatMessage:g}=(0,m.c)(),[,X]=r&&r.sort?r.sort.split(":"):[void 0,"ASC"],{push:Z,location:{pathname:w}}=(0,T.Uz)(),{trackUsage:b}=(0,o.m4)(),q=D.sort((n,tt)=>{const p=n.name.localeCompare(tt.name);return X==="DESC"?-p:p});return(0,s.jsx)(W.K,{children:q.map(n=>(0,s.jsxs)(K.Tr,{...(0,o.on)({fn(){b("willEditTokenFromList",{tokenType:a}),Z(`${w}/${n.id}`)},condition:d}),children:[(0,s.jsx)(l.Td,{maxWidth:(0,o.W8)(250),children:(0,s.jsx)(c.O,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0,children:n.name})}),(0,s.jsx)(l.Td,{maxWidth:(0,o.W8)(250),children:(0,s.jsx)(c.O,{textColor:"neutral800",ellipsis:!0,children:n.description})}),(0,s.jsx)(l.Td,{children:(0,s.jsx)(c.O,{textColor:"neutral800",children:(0,s.jsx)(o.od,{timestamp:new Date(n.createdAt)})})}),(0,s.jsx)(l.Td,{children:n.lastUsedAt&&(0,s.jsx)(c.O,{textColor:"neutral800",children:(0,s.jsx)(o.od,{timestamp:new Date(n.lastUsedAt),customIntervals:[{unit:"hours",threshold:1,text:g({id:"Settings.apiTokens.lastHour",defaultMessage:"last hour"})}]})})}),M&&(0,s.jsx)(l.Td,{children:(0,s.jsxs)(e.C,{justifyContent:"end",children:[d&&(0,s.jsx)(J,{tokenName:n.name,tokenId:n.id}),!d&&A&&(0,s.jsx)(H,{tokenName:n.name,tokenId:n.id}),i&&(0,s.jsx)(Y,{tokenName:n.name,onClickDelete:()=>P?.(n.id),tokenType:a})]})})]},n.id))})},k={edit:{id:"app.component.table.edit",defaultMessage:"Edit {target}"},read:{id:"app.component.table.read",defaultMessage:"Read {target}"}},j=({tokenName:a,tokenId:E,buttonType:D="edit",children:M})=>{const{formatMessage:P}=(0,m.c)(),{location:{pathname:i}}=(0,T.Uz)();return(0,s.jsx)(G,{forwardedAs:y.NavLink,to:`${i}/${E}`,title:P(k[D],{target:a}),children:M})},G=(0,V.default)(f.c)`
  svg {
    path {
      fill: ${({theme:a})=>a.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:a})=>a.colors.neutral800};
      }
    }
  }
`,Y=({tokenName:a,onClickDelete:E,tokenType:D})=>{const{formatMessage:M}=(0,m.c)(),{trackUsage:P}=(0,o.m4)(),[i,d]=O.useState(!1),A=()=>{d(!1),P("willDeleteToken",{tokenType:D}),E()};return(0,s.jsxs)(I.k,{paddingLeft:1,onClick:r=>r.stopPropagation(),children:[(0,s.jsx)(R.w,{onClick:()=>{d(!0)},label:M({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${a}`}),name:"delete",borderWidth:0,icon:(0,s.jsx)(U.c,{})}),(0,s.jsx)(o.cz,{onToggleDialog:()=>d(!1),onConfirm:A,isOpen:i})]})},H=({tokenName:a,tokenId:E})=>(0,s.jsx)(j,{tokenName:a,tokenId:E,buttonType:"read",children:(0,s.jsx)(h.c,{})}),J=({tokenName:a,tokenId:E})=>(0,s.jsx)(j,{tokenName:a,tokenId:E,children:(0,s.jsx)(x.c,{})})},63648:(F,L,t)=>{t.d(L,{A:()=>s,T:()=>O});const s="api-token",O="transfer-token"}}]);
